<!DOCTYPE html>
<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-5" style="max-width: 800px; background-color: #fffbea; border-radius: 15px; padding: 30px; box-shadow: 0 0 10px rgba(0,0,0,0.05);">

    <!-- íƒ€ì´í‹€ -->
    <div class="text-center mb-5">
        <h2 class="fw-bold">ğŸ“˜ ë‚˜ì˜ ì¼ê¸° ì‘ì„±</h2>
        <p class="text-muted">í•˜ë£¨ë¥¼ ëŒì•„ë³´ë©° ê¸°ë¡ì„ ë‚¨ê²¨ë³´ì„¸ìš”.</p>
    </div>

    <!-- ì¼ê¸° ì‘ì„±/ìˆ˜ì • í¼ -->
    <form th:action="@{${diaryId != null} ? '/diary/modify/' + ${diaryId} : '/diary/create'}"
          method="post" th:object="${diaryForm}">

        <!-- CSRF í† í° -->
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <!-- ë‚ ì§œì™€ ë‚ ì”¨ ì„ íƒ -->
        <div class="d-flex gap-3 mb-4">
            <!-- ë‚ ì§œ ì„ íƒ -->
            <div class="flex-grow-1">
                <label for="datepicker" class="form-label">ğŸ—“ï¸ ë‚ ì§œ ì„ íƒ</label>

                <input type="text" class="form-control" id="datepicker" name="selectedDate"
                       placeholder="ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”" readonly
                       th:value="${#temporals.format(selectedDate, 'yyyy-MM-dd')}" />
              <!-- placeholder="ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”" readonly th:value="${selectedDate}">-->
                <!--ì£¼ì„ìœ¼ë¡œ í–ˆëŠ”ë° 1925ë…„ìœ¼ë¡œ ì‹œì‘í–ˆìŒ-->
                <p id="dateMessage" class="text-muted small" style="font-style: italic; margin-top: 10px;">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            </div>

            <!-- ë‚ ì”¨ ì„ íƒ -->
            <div class="flex-grow-1">
                <label for="weather" class="form-label">ğŸŒ¤ï¸ ì˜¤ëŠ˜ì˜ ë‚ ì”¨</label>
                <select th:field="*{weather}" id="weather" class="form-select">
                    <option value="">ë‚ ì”¨ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="ë§‘ìŒ" th:selected="${weather == 'ë§‘ìŒ'}">ë§‘ìŒ â˜€ï¸</option>
                    <option value="íë¦¼" th:selected="${weather == 'íë¦¼'}">íë¦¼ â˜ï¸</option>
                    <option value="ë¹„" th:selected="${weather == 'ë¹„'}">ë¹„ â˜”ï¸</option>
                    <option value="ëˆˆ" th:selected="${weather == 'ëˆˆ'}">ëˆˆ â„ï¸</option>
                    <option value="ë°”ëŒ" th:selected="${weather == 'ë°”ëŒ'}">ë°”ëŒ ğŸ’¨</option>
                </select>
                <p id="weatherMessage" class="text-muted small" style="font-style: italic; margin-top: 10px;">ë‚ ì”¨ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            </div>
        </div>

        <!-- ì œëª© -->
        <div class="mb-4">
            <label for="subject" class="form-label">âœï¸ ì œëª©</label>
            <input type="text" th:field="*{subject}" id="subject" class="form-control" placeholder="ì˜¤ëŠ˜ì˜ ì œëª©ì€ ë¬´ì—‡ì¸ê°€ìš”?">
        </div>

        <!-- ë‚´ìš© -->
        <div class="mb-4">
            <label for="content" class="form-label">ğŸ“– ë‚´ìš©</label>
            <textarea rows="12" th:field="*{content}" id="content" class="form-control" placeholder="í•˜ë£¨ë¥¼ ììœ ë¡­ê²Œ ê¸°ë¡í•´ë³´ì„¸ìš”."></textarea>
        </div>

        <!-- ë²„íŠ¼ -->
        <div class="d-flex justify-content-center gap-3 mt-4">
            <input type="submit" class="btn btn-primary px-4"
                   th:value="${diaryId != null} ? 'ìˆ˜ì • ì™„ë£Œ' : 'ì¼ê¸° ê¸°ë¡'">
            <a th:href="@{/diary/main}" class="btn btn-outline-secondary px-4">ë’¤ë¡œê°€ê¸°</a>
        </div>
    </form>
</div>
</html>

<!-- datepicker ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    $(document).ready(function () {
        $('#datepicker').datepicker({
            format: "yyyy-mm-dd",
            language: "ko",
            autoclose: true,
            todayHighlight: true
        });

        $('#datepicker').on('change', function () {
            let selectedDate = $(this).val();
            $('#dateMessage').text(selectedDate ? 'ì„ íƒí•œ ë‚ ì§œ: ' + selectedDate : 'ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
        });

        $('#weather').on('change', function () {
            let selectedWeather = $(this).val();
            let msg = {
                'ë§‘ìŒ': 'ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€ ë§‘ê³  í™”ì°½í•œ ë‚ ì¸ê°€ìš”?! ',
                'íë¦¼': 'ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€ ê¾¸ë¦‰ê¾¸ë¦‰ ì´ë„¤ìš”. ',
                'ë¹„': 'ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€ ì¶•~ ì²˜ì§€ëŠ” ë‚ ì´êµ°ìš” ',
                'ëˆˆ': 'ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€ ëˆˆì´ ì˜¤ëŠ” ì„¤ë ˜ì¸ê°€ìš”?! ',
                'ë°”ëŒ': 'ì˜¤ëŠ˜ì˜ ê¸°ë¶„ì€ ë°”ëŒì´ ëª°ì•„ì³¤ë‚˜ìš”?'
            };
            $('#weatherMessage').text(msg[selectedWeather] || 'ë‚ ì”¨ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
        });
    });
</script>
